2009-11-22  Aurelien Jarno  <aurelien@aurel32.net>

	* nis/nss_nis/nis-hosts.c (_nss_nis_gethostbyname4_r): If
	NIS is not configured, set errnop and herrnop appropriately.

--- a/nis/nss_nis/nis-hosts.c
+++ b/nis/nss_nis/nis-hosts.c
@@ -456,7 +456,11 @@ _nss_nis_gethostbyname4_r (const char *name, struct gaih_addrtuple **pat,
 {
   char *domain;
   if (yp_get_default_domain (&domain))
-    return NSS_STATUS_UNAVAIL;
+    {
+      *herrnop = HOST_NOT_FOUND;
+      *errnop = errno;
+      return NSS_STATUS_UNAVAIL;
+    }
 
   /* Convert name to lowercase.  */
   size_t namlen = strlen (name);
